---
source: crates/ignis_codegen_c/tests/golden_c.rs
expression: c_code
---
#include "types.h"

// Type forward declarations
typedef struct Owned Owned;
typedef struct Person Person;

// Type definitions
struct Owned {
    i32 field_0;
    uint8_t __ignis_drop_state;
};
struct Person {
    struct Owned field_0;
    struct Owned field_1;
    i32 field_2;
};

void Owned_drop(struct Owned* self);
void __ignis_user_main(void);

void Owned_drop(struct Owned* self) {
    // Locals
    struct Owned* l0; // self

    // Temporaries
    struct Owned* t0;

entry_0:
    l0 = self;
    return;
}

void __ignis_user_main(void) {
    // Locals
    struct Person l0; // p
    struct Owned l1; // _
    struct Owned l2; // _

    // Temporaries
    struct Owned* t0;
    struct Owned t1;
    struct Owned* t2;
    struct Owned t3;
    struct Person* t4;

entry_0:
    t0 = &l1;
    (t0)->field_0 = 1;
    (t0)->__ignis_drop_state = 0;
    t1 = l1;
    t2 = &l2;
    (t2)->field_0 = 2;
    (t2)->__ignis_drop_state = 0;
    t3 = l2;
    t4 = &l0;
    (t4)->field_0 = t1;
    (t4)->field_1 = t3;
    (t4)->field_2 = 30;
    if (!(l0.field_0).__ignis_drop_state) {
    Owned_drop(&l0.field_0);
    (l0.field_0).__ignis_drop_state = 1;
}
if (!(l0.field_1).__ignis_drop_state) {
    Owned_drop(&l0.field_1);
    (l0.field_1).__ignis_drop_state = 1;
}
    return;
}

int main(int argc, char** argv) {
    (void)argc;
    (void)argv;
    __ignis_user_main();
    return 0;
}
